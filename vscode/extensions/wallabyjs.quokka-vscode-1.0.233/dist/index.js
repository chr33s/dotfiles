/*
 * quokka-vscode - v1.0.233
 * Copyright (c) 2017-2019 WallabyJs - All Rights Reserved.
 */

!function a(r,u,c){process.env.WALLABY_PRODUCTION=!0;var l="function"==typeof require&&require;module.exports=function i(o,e){if(!u[o]){if(!r[o]){var t="function"==typeof require&&require;if(!e&&t)return t(o,!0);if(l)return l(o,!0);var n=new Error("Cannot find module '"+o+"'");throw n.code="MODULE_NOT_FOUND",n}var s=u[o]={exports:{}};r[o][0].call(s.exports,function(e){var t=r[o][1][e];return i(t||e)},s,s.exports,a,r,u,c)}return u[o].exports}(c[0])}({1:[function(u,e,t){"use strict";var i=this&&this.__awaiter||function(s,a,r,u){return new(r||(r=Promise))(function(e,t){function i(e){try{n(u.next(e))}catch(e){t(e)}}function o(e){try{n(u.throw(e))}catch(e){t(e)}}function n(t){t.done?e(t.value):new r(function(e){e(t.value)}).then(i,o)}n((u=u.apply(s,a||[])).next())})},c=this&&this.__generator||function(i,o){var n,s,a,e,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return r.label++,{value:t[1],done:!1};case 5:r.label++,s=t[1],t=[0];continue;case 7:t=r.ops.pop(),r.trys.pop();continue;default:if(!(a=0<(a=r.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){r=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){r.label=t[1];break}if(6===t[0]&&r.label<a[1]){r.label=a[1],a=t;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(t);break}a[2]&&r.ops.pop(),r.trys.pop();continue}t=o.call(i,r)}catch(e){t=[6,e],s=0}finally{n=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},r=u("fs"),l=u("path"),p=u("vscode"),h=u("vsls/vscode"),d=u("./lib/compositeDisposable"),o=p.window,f="quokkajs",_=function(){function r(){}return r.prototype.activate=function(a){return i(this,void 0,void 0,function(){var t,i,o,n,s;return c(this,function(e){switch(e.label){case 0:return(t=this)._disposables=new d,t._setupStatusIndicator(),i=u(a.globalState.get("corePath")),o={context:a,coreClient:i,statusBar:t._statusBar,deactivate:function(){return t.deactivate()},version:r._getVersion()},[4,h.getApiAsync()];case 1:return n=e.sent(),s=u("./lib/controller"),t._controller=new s(o,n,f),t._controller.activate(),t._disposables.add(function(){return t._controller.deactivate()}),t._disposables.add(function(){return n.unshareService(f)}),[2]}})})},r._getVersion=function(){var e=1,t=0;try{var i=p.version.split(".");e=parseInt(i[0],10),t=parseInt(i[1],10)}catch(e){}return{major:e,minor:t}},r.prototype._setupStatusIndicator=function(){var i=this;i._statusBar=o.createStatusBarItem(p.StatusBarAlignment.Right,Number.NEGATIVE_INFINITY),i._statusBar.show();var e=i._statusBar.hide.bind(i._statusBar),t=i._statusBar.dispose.bind(i._statusBar);i._statusBar.hide=function(){i._statusBar.stopProgress(),i._statusBar._mainText="",i._statusBar._extensionText="",i._statusBar.updateText(),e()},i._statusBar.dispose=function(){i._statusBar.stopProgress(),t()},i._statusBar.displayProgress=function(){var e=0,t=["[=-----]","[-=----]","[--=---]","[---=--]","[----=-]","[-----=]","[----=-]","[---=--]","[--=---]","[-=----]"];clearInterval(i._statusBar._progress),i._statusBar._progress=setInterval(function(){i._statusBar.setMainText(t[e=++e%t.length]+"   "),i._statusBar._doUpdateText()},150)},i._statusBar.setMainText=function(e){i._statusBar._mainText=e},i._statusBar.setExtensionText=function(e){i._statusBar._extensionText=e},i._statusBar.updateText=function(){return i._statusBar._doUpdateText()},i._statusBar._doUpdateText=function(){i._statusBar.text=(i._statusBar._mainText||"")+" "+(i._statusBar._extensionText||"")},i._statusBar.stopProgress=function(){clearInterval(i._statusBar._progress),delete i._statusBar._progress},i._statusUpdater=function(e){i._statusBar.tooltip=e},i._disposables.add(function(){i._removeStatusIndicator()}),i._statusBar.hide()},r.prototype._hideStatusIndicator=function(){this._statusBar&&(this._statusBar.text="",this._statusBar.tooltip="",this._statusBar.hide()),this._statusUpdater=function(){}},r.prototype._removeStatusIndicator=function(){this._statusBar&&this._statusBar.dispose(),this._statusUpdater=function(){}},r.prototype.deactivate=function(){this._disposables.dispose()},r}();t.activate=function(o){var e=new _;o.subscriptions.push({dispose:function(){return e.deactivate()}});var t=_._getVersion();if(t.major<=1&&t.minor<18){var i=process.exit,n=process.exit=function(){(function(){e.deactivate(),i.apply(process,arguments)}).apply(null,arguments)};process.on("SIGINT",function(){n.apply(null,arguments)}),process.on("SIGTERM",function(){n.apply(null,arguments)}),process.on("exit",function(){n.apply(null,arguments)})}try{var s=p.workspace.getConfiguration();if(s){var a=s.get("quokka.colors",{});a&&Object.keys(a).forEach(function(t){try{if(!t)return;var e=o.asAbsolutePath(l.join("images",t+".svg"));if(!r.existsSync(e))return;var i=r.readFileSync(e).toString().replace(/fill:#.[^;]*/,"fill:"+a[t]);r.writeFileSync(e,i)}catch(e){console.error("Failed to set icon "+t+" type to "+a[t]+". "+e.message)}})}}catch(e){}e.activate(o)}},{"./lib/compositeDisposable":4,"./lib/controller":5,fs:void 0,path:void 0,vscode:void 0,"vsls/vscode":void 0}],2:[function(i,e,t){"use strict";var o=i("vscode"),n=i("path");t.activate=function(e){var t=o.workspace.getConfiguration()&&o.workspace.getConfiguration().get("quokka.debug",!1);t?(global.originalRequire=i,e.globalState.update("corePath","../../wallaby/client")):e.globalState.update("corePath","./wallaby/client"),t?i("./out/extension").activate(e):"dist"===n.basename(__dirname)?i("./extension").activate(e):(global.originalRequire=i)("./dist/index").activate(e)}},{"./extension":1,path:void 0,vscode:void 0}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=e("path"),n=e("fs"),s=e("os"),a=e("vscode"),r=function(){function e(e,t){this.disposable=void 0,this.disposed=!1,this.start=e||new Date(Date.UTC(2019,4,15,0,0,0,0)),this.end=t||new Date(Date.UTC(2019,4,22,0,0,0,0)),this.config=o.join(s.homedir(),".quokka","state.json"),this.nextCheckTime=void 0}return e.prototype.setup=function(){var e=this;new Date>this.end?this.deleteStateConfig():(this.nextCheckTime=this.getNextCheckTime()||this.start,this.nextCheckTime<this.end&&(this.checkAndShowMessage(),this.disposable=a.window.onDidChangeActiveTextEditor(function(){e.checkAndShowMessage()})))},e.prototype.checkAndShowMessage=function(){var e=new Date;!this.disposed&&e>this.start&&e<this.end&&this.nextCheckTime&&e>=this.nextCheckTime&&(this.nextCheckTime=this.setNextCheckTime(),this.showMessageAndHandleUserResponse())},e.prototype.showMessageAndHandleUserResponse=function(){var t=this;try{a.window.showInformationMessage("Get Quokka.js PRO today with our limited time 40% discount! 10% of sale proceeds will be donated to the Rottnest Foundation to support their üê≠ Quokka population.",{title:"Buy License",url:a.Uri.parse("https://quokkajs.com/pro/#personal-pro")},{title:"Read More",url:a.Uri.parse("https://quokkajs.com/pro")},{title:"Do not show again",dontShow:!0}).then(function(e){return t.handleUserResponse(e)})}catch(e){}},e.prototype.handleUserResponse=function(e){e&&(e.dontShow?(this.setNextCheckTimeToEndDate(),this.dispose()):e.url&&a.commands.executeCommand("vscode.open",e.url))},e.prototype.setNextCheckTimeToEndDate=function(){try{this.nextCheckTime=this.end,n.writeFileSync(this.config,JSON.stringify({nextCheck:this.end}))}catch(e){}},e.prototype.deleteStateConfig=function(){try{n.existsSync(this.config)&&n.unlinkSync(this.config)}catch(e){}},e.prototype.dispose=function(){this.disposable&&this.disposable.dispose(),this.disposed=!0},e.prototype.setNextCheckTime=function(){var e=new Date,t=new Date(e.setDate(e.getDate()+1));try{n.writeFileSync(this.config,JSON.stringify({nextCheck:t}))}catch(e){}return t},e.prototype.getNextCheckTime=function(){try{if(n.existsSync(this.config)){var e=n.readFileSync(this.config).toString(),t=JSON.parse(e);return new Date(t.nextCheck)}return}catch(e){this.deleteStateConfig()}},e}();i.SalesEvent=r},{fs:void 0,os:void 0,path:void 0,vscode:void 0}],4:[function(e,t,i){"use strict";var o=function(){function e(){this._disposables=[]}return e.prototype.add=function(e){e.dispose?this._disposables.push(e):this._disposables.push({dispose:e})},e.prototype.dispose=function(){this._disposables.forEach(function(e){return e.dispose()})},e}();t.exports=o},{}],5:[function(e,t,i){"use strict";var o,n=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),l=this&&this.__awaiter||function(s,a,r,u){return new(r||(r=Promise))(function(e,t){function i(e){try{n(u.next(e))}catch(e){t(e)}}function o(e){try{n(u.throw(e))}catch(e){t(e)}}function n(t){t.done?e(t.value):new r(function(e){e(t.value)}).then(i,o)}n((u=u.apply(s,a||[])).next())})},p=this&&this.__generator||function(i,o){var n,s,a,e,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return r.label++,{value:t[1],done:!1};case 5:r.label++,s=t[1],t=[0];continue;case 7:t=r.ops.pop(),r.trys.pop();continue;default:if(!(a=0<(a=r.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){r=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){r.label=t[1];break}if(6===t[0]&&r.label<a[1]){r.label=a[1],a=t;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(t);break}a[2]&&r.ops.pop(),r.trys.pop();continue}t=o.call(i,r)}catch(e){t=[6,e],s=0}finally{n=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},d=e("path"),f=e("fs"),_=e("os"),v=e("vscode"),m=global._,a=e("./SalesEvent"),s=global.EventEmitter,r=e("./valueExplorer"),g=e("./compositeDisposable"),k=e("./outputBuilder"),y=v.workspace,S=v.window,u=["showOutput","createFile","makeQuokkaFromExistingFile","runOnSave","runOnce","createJavaScriptFile","createTypeScriptFile","showInstrumentedFile","stopCurrent","stopAll","installMissingPackageToProject","installMissingPackageToQuokka","installQuokkaPlugin","goToLineInQuokkaFile","showLicense","switchToPro","switchToCommunity","selectWorkspaceFolder","addImport","addRequire","showValue","copyValue","copyExpressionPath","copyExpressionData"],x={javascript:".js",javascriptreact:".js",plaintext:".js",typescript:".ts",typescriptreact:".tsx"},C=0,c=1,w=2,h=function(s){function h(e,t,i){var o=s.call(this)||this,n=o;return o._state=e,o._context=e.context,o._statusBar=e.statusBar,o._deactivator=e.deactivate,o._Session=e.coreClient.Session,o._utils=e.coreClient.utils,o._outputDocumentSelector={language:"wallaby-output"},o._setupVersionSpecificComponents(e.version),o._disposables=new g,m.each(u,function(t){return n._disposables.add(v.commands.registerCommand("quokka."+t,function(e){try{return n[t](e)}catch(e){console.error(e)}}))}),v.commands.executeCommand("setContext","quokka.isLiveShareClient",!1),o._initializeCoverageDecorationTypes(),n._disposables.add(v.workspace.onDidChangeConfiguration(function(e){n._reInitializeCoverageDecorationTypes()})),o._hideAfterContentDecorationType=S.createTextEditorDecorationType({isWholeLine:!0,after:{margin:"0 0 0 -10000px"}}),o._debugOutputChannel={appendLine:function(e,t){console.log("%c "+e,"color: "+("error"===t?"red":"darkgreen"))}},o._activeSessions=[],o._activeSession=null,o.outputChannel=S.createOutputChannel("Quokka"),o.outputChannel.append(""),S.onDidChangeActiveTextEditor(function(t){if(t){var e=o._activeSessions.find(function(e){return t.document===e.textDocument});e&&o._checkAndSyncSession(e)}}),o._setupEnvironment(),o._setupLiveSharing(t,i),v.commands.executeCommand("setContext","quokka.startedAtLeastOnce",!1),o._valueExplorer=new r(o._context),o.on("started",function(){o._liveShareClientActive()||v.commands.executeCommand("setContext","quokka.startedAtLeastOnce",!0)}),o}return n(h,s),h.prototype._initializeCoverageDecorationTypes=function(){this._coverageDecorationTypes={1:this._createCoverageDecorationType("notCovered"),2:this._createCoverageDecorationType("covered"),3:this._createCoverageDecorationType("partiallyCovered"),4:this._createCoverageDecorationType("errorSource"),5:this._createCoverageDecorationType("errorPath")},this._coverageOverrideState=this._currentCoverageOverrideState()},h.prototype._currentCoverageOverrideState=function(){var e=v.workspace.getConfiguration();return JSON.stringify([e.get("quokka.lightTheme.log.decorationAttachmentRenderOptions",{}),e.get("quokka.lightTheme.error.decorationAttachmentRenderOptions",{}),e.get("quokka.darkTheme.log.decorationAttachmentRenderOptions",{}),e.get("quokka.darkTheme.error.decorationAttachmentRenderOptions",{})])},h.prototype._reInitializeCoverageDecorationTypes=function(){var t=this;this._coverageOverrideState!==this._currentCoverageOverrideState()&&(this._activeSessions.forEach(function(e){t._clearDecorations(e)}),this._initializeCoverageDecorationTypes(),this._activeSessions.forEach(function(e){t._updateDocuments(e,e.documentUpdates)}))},h.prototype._setupLiveSharing=function(u,c){return l(this,void 0,void 0,function(){var t,i,o,n,s,a,r=this;return p(this,function(e){switch(e.label){case 0:return u?[3,1]:(this._debugOutputChannel.appendLine("Quokka.js Live Share integration disabled, VSLS not found."),[2]);case 1:return this._liveShare={api:u},t=this._liveShare,[4,u.shareService(c)];case 2:return t.server=e.sent(),i=this._liveShare,[4,u.getSharedService(c)];case 3:if(i.client=e.sent(),!this._liveShare.server||!this._liveShare.client)return this._debugOutputChannel.appendLine('Could not create a shared service. You have to set "liveshare.features" to "experimental" in your user settings in order to use live sharing.'),delete this._liveShare,[2];e.label=4;case 4:return o=function(){return m.uniq(r._activeSessions.map(function(e){return{file:e.liveShareFileName,originalFile:e.textDocument.uri,fileName:e.fileName,documentUpdates:e.documentUpdates,stats:e.stats,mode:e.mode,headerData:e.headerData,liveConsoleOutput:e.allLiveConsoleOutput,status:e.status}}))},n=function(t){var i=r._liveShare.activeServerSessions.find(function(e){return 0===t.document.uri.scheme.localeCompare(e.file.scheme)&&0===t.document.uri.path.localeCompare(e.file.path)});if(i){r._start(t.document,t,i.mode);var e=a(i.file);r.processStarted(e),e.output.setHeaderData(i.headerData),e.headerData=i.headerData,i.documentUpdates[i.file.path]=i.documentUpdates[i.fileName],delete i.documentUpdates[i.fileName],r._updateDocuments(e,i.documentUpdates),e.stats=i.stats,e.status=i.status,r.processStats(e),e.liveConsoleOutput=i.liveConsoleOutput,e.liveConsoleOutput&&e.liveConsoleOutput.length&&r._displayLiveConsoleOutput(e,e.liveConsoleOutput),r._liveShare.activeServerSessions=r._liveShare.activeServerSessions.filter(function(e){return e!=i})}},this._liveShare.api.onDidChangePeers(function(t){return l(r,void 0,void 0,function(){return p(this,function(e){return this._liveShareServerActive()&&t.added.length&&(this._liveShare.serverAllowed||this._activeSessions.length&&(S.showWarningMessage("You have not given permission to run Quokka.js in your Live Share Session. All Quokka.js instances have been stopped."),this.stopAll())),[2]})})}),this._context.subscriptions.push(this._liveShare.server.onDidChangeIsServiceAvailable(function(i){return l(r,void 0,void 0,function(){var t=this;return p(this,function(e){return i?(this._activeSessions.forEach(function(e){e.liveShareFileName=t._liveShare.api.convertLocalUriToShared(e.textDocument.uri)}),this._liveShare.disposable=new g,this._liveShare.disposable.add(function(){return delete t._liveShare.serverAllowed}),this._liveShare.serverAllowed=!1,this._activeSessions.length&&this._showLiveShareWarningMessage()):(this._liveShare.disposable&&this._liveShare.disposable.dispose(),delete this._liveShare.disposable),[2]})})})),this._context.subscriptions.push(this._liveShare.client.onDidChangeIsServiceAvailable(function(o){return l(r,void 0,void 0,function(){var t,i=this;return p(this,function(e){switch(e.label){case 0:return o?(v.commands.executeCommand("setContext","quokka.isLiveShareClient",!0),v.commands.executeCommand("setContext","quokka.startedAtLeastOnce",!1),this._liveShare.disposable=new g,this._liveShare.disposable.add(function(){return delete i._liveShare.activeServerSessions}),this._liveShare.disposable.add(S.onDidChangeActiveTextEditor(function(e){return n(e)})),t=this._liveShare,[4,this._liveShare.client.request("init",[])]):[3,2];case 1:return t.activeServerSessions=e.sent(),[3,3];case 2:v.commands.executeCommand("setContext","quokka.isLiveShareClient",!0),this._liveShare.disposable&&this._liveShare.disposable.dispose(),delete this._liveShare.disposable,e.label=3;case 3:return[2]}})})})),s=function(t){return S.visibleTextEditors.find(function(e){return 0===e.document.uri.scheme.localeCompare(t.scheme)&&0===e.document.uri.path.localeCompare(t.path)})},a=function(t){return r._activeSessions.find(function(e){return e.fileName===t.path})},this._liveShare.server.onRequest("init",function(){return o()}),this._liveShare.client.onNotify("busy",function(e){var t=a(e.file);t&&r.processSessionBusy(t)}),this._liveShare.client.onNotify("stopped",function(t){var i=r._liveShare.activeServerSessions.find(function(e){return 0===t.file.scheme.localeCompare(e.file.scheme)&&0===t.file.path.localeCompare(e.file.path)});i&&r._liveShare.activeServerSessions.filter(function(e){return e!=i});var e=a(t.file);e&&(r._stop(e),r._hideStatusIndicator())}),this._liveShare.client.onNotify("started",function(t){var e=s(t.file);if(e){r._start(e.document,e,t.data.mode);var i=a(t.file);r.processStarted(i)}else{r._liveShare.activeServerSessions.find(function(e){return 0===t.file.uri.scheme.localeCompare(e.file.scheme)&&0===t.file.uri.path.localeCompare(e.file.path)})||r._liveShare.activeServerSessions.push({file:t.file,originalFile:t.originalFile,fileName:t.fileName,documentUpdates:{},stats:void 0,status:void 0,mode:t.data.mode,headerData:null})}}),this._liveShare.client.onNotify("stats",function(t){var e=r._liveShare.activeServerSessions.find(function(e){return 0===t.file.scheme.localeCompare(e.file.scheme)&&0===t.file.path.localeCompare(e.file.path)});e&&(e.stats=t.data,delete e.status,delete e.liveConsoleOutput,delete e.allLiveConsoleOutput);var i=a(t.file);i&&(i.stats=t.data,delete i.status,delete i.liveConsoleOutput,delete i.allLiveConsoleOutput,r.processStats(i))}),this._liveShare.client.onNotify("documentUpdates",function(t){var e=r._liveShare.activeServerSessions.find(function(e){return 0===t.file.scheme.localeCompare(e.file.scheme)&&0===t.file.path.localeCompare(e.file.path)});e&&(e.documentUpdates=t.data);var i=a(t.file);i&&(t.data[t.file.path]=t.data[t.fileName],delete t.data[t.fileName],r._updateDocuments(i,t.data))}),this._liveShare.client.onNotify("consoleOutput",function(e){var t=a(e.file);t&&r._displayLiveConsoleOutput(t,e.data)}),this._liveShare.client.onNotify("configChanged",function(t){var e=r._liveShare.activeServerSessions.find(function(e){return 0===t.file.scheme.localeCompare(e.file.scheme)&&0===t.file.path.localeCompare(e.file.path)});e&&(e.headerData=t.data);var i=a(t.file);i&&(i.output.setHeaderData(t.data),i.headerData=t.data)}),[2]}})})},h.prototype._setupEnvironment=function(){var t=this;this._quokkaFolder=d.join(_.homedir(),".quokka"),this._lkp=d.join(this._quokkaFolder,".qlc");try{f.existsSync(this._quokkaFolder)||f.mkdirSync(this._quokkaFolder)}catch(e){}var i=this._loadQuokkaConfig();this._pro=!0===i.pro,!0!==this._pro?(this._salesEvent=new a.SalesEvent,this._salesEvent.setup()):(new a.SalesEvent).deleteStateConfig(),!0!==i.pro&&!1!==i.pro&&(S.showInformationMessage("Would you like to try 'Pro' edition features or to only use the 'Community' edition features?",{title:"'Pro' features as well",pro:!0},{title:"'Community' features only",pro:!1}).then(function(e){e&&(i.pro=e.pro,t._saveQuokkaConfig(i))}),S.showInformationMessage("You are using Quokka.js 'Community' edition (free). Quokka.js 'Pro' edition with some advanced features is also available.",{title:"More info",url:v.Uri.parse("https://quokkajs.com/pro")}).then(function(e){e&&e.url&&v.commands.executeCommand("vscode.open",e.url)}))},h.prototype._quokkaConfigPath=function(){return d.join(this._quokkaFolder,"config.json")},h.prototype._loadQuokkaConfig=function(){var t,e=this._quokkaConfigPath(),i={};try{t=f.readFileSync(e).toString(),i=JSON.parse(t)}catch(e){t&&S.showWarningMessage("Looks like your quokka config.json file has invalid syntax, it should be a valid JSON file.")}return i},h.prototype._saveQuokkaConfig=function(e){f.writeFileSync(this._quokkaConfigPath(),JSON.stringify(e))},h.prototype._getThemableDecorationRenderOptions=function(e,t){var i=e?"error":"log",o=v.workspace.getConfiguration().get("quokka."+t+"Theme."+i+".decorationAttachmentRenderOptions",{color:"light"===t?"error"===i?"#c80000":"#0000ff":"error"===i?"#fe536a":"rgba(86, 156, 214, 1)",margin:"1.2em"});return Object.keys(o).forEach(function(e){null===o[e]&&delete o[e]}),delete o.contentText,delete o.contentIconPath,o},h.prototype._createCoverageDecorationType=function(e){return S.createTextEditorDecorationType({isWholeLine:!0,rangeBehavior:1,gutterIconPath:this._context.asAbsolutePath(d.join("images",e+".svg")).split("\\").join("/"),light:{after:this._getThemableDecorationRenderOptions("errorSource"===e,"light")},dark:{after:this._getThemableDecorationRenderOptions("errorSource"===e,"dark")}})},h.prototype.addImport=function(e){S.activeTextEditor&&h._addCode(S.activeTextEditor,"import "+e+" from '"+e+"';\n")},h.prototype.addRequire=function(e){S.activeTextEditor&&h._addCode(S.activeTextEditor,"const "+e+" = require('"+e+"');\n")},h._addCode=function(e,t){var i=new v.WorkspaceEdit;i.insert(e.document.uri,new v.Position(0,0),t),v.workspace.applyEdit(i)},h.prototype.createFile=function(){var t=this;S.showQuickPick(["JavaScript","TypeScript"]).then(function(e){return t._createLanguageFile(e)})},h.prototype.showOutput=function(){this._activeSession&&this.outputChannel&&this.outputChannel.show(!0)},h.prototype.createJavaScriptFile=function(){this._createLanguageFile("JavaScript")},h.prototype.createTypeScriptFile=function(){this._createLanguageFile("TypeScript")},h.prototype.makeQuokkaFromExistingFile=function(){var e=this;this._runIfAllowed(function(){return e._runFromExistingFile(C)})},h.prototype.runOnSave=function(){var e=this;this._pro?this._runIfAllowed(function(){return e._runFromExistingFile(c)}):this._showNotification({suggestProEdition:!0,type:"warning",text:"The feature is only available in 'Pro' edition."},this._activeSession)},h.prototype.runOnce=function(){var o=this;this._pro?this._runIfAllowed(function(){var e=S.activeTextEditor;if(e){var t=e.document;if(t){var i=o._activeSessions.find(function(e){return e.textDocument===t});i&&i.mode===w?i.changes.length?o._processDocumentContentChange(i,t,[],!0):i.runTests({file:i.fileName}):o._runFromExistingFile(w)}}}):this._showNotification({suggestProEdition:!0,type:"warning",text:"The feature is only available in 'Pro' edition."},this._activeSession)},h.prototype.stopCurrent=function(){var t=S.activeTextEditor,e=t&&t.document&&this._activeSessions.find(function(e){return e.textDocument===t.document})||this._activeSession;e&&this._stop(e)},h.prototype.stopAll=function(){var t=this;this._activeSessions.slice().forEach(function(e){return t._stop(e)})},h.prototype.showInstrumentedFile=function(){var t=this;this._activeSession&&this._activeSession.requestInstrumentedFile({path:this._activeSession.fileName},function(e){t._activeSession.output.clearAndRenderHeader(),t._activeSession.output.appendConsoleMessage({text:e,type:"warn"})})},h.prototype.installMissingPackageToProject=function(){this._installPackage(!0)},h.prototype.installMissingPackageToQuokka=function(){this._installPackage()},h.prototype.installQuokkaPlugin=function(e){this._installPackage(!1,e)},h.prototype.showValue=function(){this._showValue("showValue")},h.prototype.copyValue=function(){this._showValue("copyValue")},h.prototype._showValue=function(e){var t=S.activeTextEditor;if(t){var i=this._activeSession;if(i&&i.textDocument&&t.document===i.textDocument){var o=t.selection;if(o&&o.end){var n=i.textDocument.offsetAt(o.end),s=i.textDocument.getText(),a="copyValue"===e?"/*?+___COPY___*/":"/*?*/";i.fileChangedInEditor(i.fileName,s.substring(0,n)+a+s.substr(n),void 0,e),"showValue"===e&&this._scheduleOnResultsAvailable(i.fileName,o.end,function(){return v.commands.executeCommand("editor.action.showHover")})}}}},h.prototype._scheduleOnResultsAvailable=function(e,t,i){this._runOnResultsAvailable={fileName:e,selectionEnd:t,action:i}},h.prototype._runScheduledActionOnResultsAvailable=function(){if(this._runOnResultsAvailable){var e=S.activeTextEditor;if(e){var t=this._activeSession;if(t&&t.textDocument&&e.document===t.textDocument){var i=e.selection;if(i&&i.end&&t.fileName===this._runOnResultsAvailable.fileName&&i.end===this._runOnResultsAvailable.selectionEnd)try{this._runOnResultsAvailable.action()}finally{delete this._runOnResultsAvailable}}}}},h.prototype.copyExpressionPath=function(e){e&&e.copyExpressionPath()},h.prototype.copyExpressionData=function(e){e&&e.copyExpressionData()},h.prototype.goToLineInQuokkaFile=function(e){if(this._activeSession)if(e){var i=(e=e.split(","))[0]-1,o=(e[1]||1)-1;S.showTextDocument(this._activeSession.textDocument).then(function(e){var t=new v.Position(i,o);e.revealRange(new v.Range(t,t)),e.selection=new v.Selection(t,t)})}else S.showTextDocument(this._activeSession.textDocument)},h.prototype._installPackage=function(e,t){if(this._activeSession)if(t)this._activeSession.status="progress",this._updateStatus(this._activeSession,"progress"),this._activeSession.runTests({file:this._activeSession.fileName,installPackage:{name:t,plugin:{editConfig:!0}}});else{if(e&&!this._projectRoot())return void S.showWarningMessage("Cannot install a package into project because quokka is running outside of an opened project.");if(!this._pro)return void this._showNotification({suggestProEdition:!0,type:"warning",text:"The feature is only available in 'Pro' edition."},this._activeSession);if(!this._activeSession.stats||!this._activeSession.stats.errors)return void S.showWarningMessage("No missing packages to install.");var i=m.find(this._activeSession.stats.errors,function(e){return e.missingPackage});if(!i||!i.missingPackage)return void S.showWarningMessage("No missing packages to install.");this._activeSession.status="progress",this._updateStatus(this._activeSession,"progress"),this._activeSession.runTests({file:this._activeSession.fileName,installPackage:{name:i.missingPackage,local:e}})}else S.showWarningMessage("Cannot install a package because quokka is not running.")},h.prototype._setupVersionSpecificComponents=function(e){var t=e.major,i=e.minor;1<=t&&11<=i&&(this._outputDocumentSelector.scheme="*"),1<=t&&16<=i&&(this._multiFolderWorkspaces=!0)},h.prototype._createLanguageFile=function(e){var i=this;return e&&y.openTextDocument({language:e.toLowerCase()}).then(function(t){return S.showTextDocument(t).then(function(e){return i._start(t,e,C)})})},h.prototype._stop=function(t){t.disposable&&t.disposable.dispose(),this._activeSessions.splice(this._activeSessions.findIndex(function(e){return e===t}),1),this._hideStatusIndicator(),m.isEmpty(this._activeSessions)&&this.emit("allSessionStopped")},h.prototype._hideStatusIndicator=function(){this._statusBar.stopProgress(),this._statusBar.hide()},h.prototype._relativeNormalizedFilePath=function(e){return this._utils.normalizePath(d.relative(this._projectRoot(),e))},h.prototype._runFromExistingFile=function(e){var t=S.activeTextEditor;if(t){var i=t.document;if(i){var o=this._activeSessions.find(function(e){return e.textDocument===i});o&&this._stop(o),x[i.languageId]?this._start(i,t,e):"output"===i.uri.scheme&&"wallaby-output"===i.languageId?this._activeSession&&!this._activeSession.isDisposed()&&this._start(this._activeSession.textDocument,this._activeSession.editors[0],this._activeSession.mode):S.showWarningMessage('Language "'+i.languageId+'" is not supported')}}},h.prototype._runIfAllowed=function(e){!this._liveShareServerActive()||this._liveShare.serverAllowed?e():this._showLiveShareWarningMessage(e)},h.prototype._showLiveShareWarningMessage=function(t){var i=this;S.showWarningMessage("When sharing outside read-only mode, the Quokka.js extension will execute CODE WRITTEN BY OTHERS ON YOUR COMPUTER. Select 'Allow' to continue executing Quokka.js during your Live Share Session.",{title:"Allow",allow:!0},{title:"Deny",allow:!1}).then(function(e){i._liveShare.serverAllowed=!(!e||!e.allow),i._liveShare.serverAllowed?t&&t():i._activeSessions.length&&(S.showInformationMessage("All Quokka.js instances have been stopped."),i.stopAll())})},h.prototype._liveShareClientActive=function(){return!!(this._liveShare&&this._liveShare.client&&this._liveShare.client.isServiceAvailable)},h.prototype._liveShareServerActive=function(){return!!(this._liveShare&&this._liveShare.server&&this._liveShare.server.isServiceAvailable)},h.prototype._sendToLiveShareClients=function(e,t,i){this._liveShareServerActive()&&this._liveShare.server.notify(e,{file:t.liveShareFileName,originalFile:t.textDocument.uri,fileName:t.fileName,data:i})},h.prototype._start=function(o,e,t){var i=this;this._updateConfigurationFromSettings(),h._checkConfigurationSettings();var n=this._liveShareClientActive(),s=n?{}:new this._Session;n&&(s.isDisposed=function(){return!1},s.stop=function(){});var a,r,u=new g;if(this._activeSession&&this._activeSession.output.disableChannel(),u.add(function(){i._sendToLiveShareClients("stopped",s)}),u.add(function(){i._valueExplorer.remove(s)}),u.add(function(){delete i._runOnResultsAvailable}),this._watcher||n||(this._watcher=y.createFileSystemWatcher("**/*.*"),this._disposables.add(this._watcher)),n||(u.add(v.languages.registerHoverProvider(o.languageId,{provideHover:function(e,t){if(e===o&&!m.isEmpty(s.errorDataByLine)){var i=(s.errorDataByLine[t.line]||{}).hover;if(i)return new v.Hover(i.value)}}})),u.add(v.languages.registerCodeActionsProvider(o.languageId,{provideCodeActions:function(e,t){if(e===o&&!m.isEmpty(s.errorDataByLine)){var i=(s.errorDataByLine[t.start.line]||{}).commands;if(i)return i}}}))),t===C&&!n){var c=function(){s.runTests({file:s.fileName,externalFileChange:!0})};u.add(this._watcher.onDidCreate(c)),u.add(this._watcher.onDidChange(c)),u.add(this._watcher.onDidDelete(c))}(s.mode=t,s.disposable=u,s.textDocument=o,s.changes=[],s.fileName="quokka"+x[o.languageId],s.documentUpdates={},"file"===o.uri.scheme)?a=(r=o.uri.path.split("/"))[r.length-1]:a="vsls"===o.uri.scheme?(r=o.uri.path.split("/"))[r.length-1]:o.uri.path+x[o.languageId];if(s.id=a,"file"===o.uri.scheme&&this._projectRoot(o.uri.fsPath)){var l=this._relativeNormalizedFilePath(o.uri.fsPath);l&&(s.fileName=l,this._liveShareServerActive()&&(s.liveShareFileName=this._liveShare.api.convertLocalUriToShared(o.uri)))}"vsls"===o.uri.scheme&&n&&(s.fileName=o.uri.path),s.editors=[e],s.liveConsoleOutput=[],s.allLiveConsoleOutput=[],this._activeSessions.push(s),u.add(y.onDidCloseTextDocument(function(e){o===e&&i._stop(s)})),u.add(y.onDidChangeTextDocument(function(e){o===e.document&&(s.mode===C?i._processDocumentContentChange(s,e.document,e.contentChanges,!0):(i._hideStatusIndicator(),i._clearDecorations(s),i._processDocumentContentChange(s,e.document,e.contentChanges,!1)))})),u.add(y.onDidSaveTextDocument(function(e){o===e&&i._processDocumentContentChange(s,e,[],!0)})),u.add(S.onDidChangeActiveTextEditor(function(e){var t=s.editors.includes(e);s.editors=s.editors.filter(function(e){return S.visibleTextEditors.includes(e)}),S.visibleTextEditors.filter(function(e){return e.document===o}).forEach(function(e){s.editors.includes(e)||(s.editors.push(e),i._updateDocuments(s,s.documentUpdates))}),t&&i._updateDocuments(s,s.documentUpdates)}));var p=m.bind(this._absoluteFilePath,this);s.output=new k(this.outputChannel,s.fileName,p,this._state.coreClient.dmp,s.disposable,this._outputDocumentSelector,!!this._projectRoot(),this._liveShareClientActive(),s.id,this._compactMessageOutput),this._colorizeOutput?s.output.useMarkup():s.output.disableMarkup(),n||(s.start({localRoot:this._projectRoot(),quokkaFolder:this._quokkaFolder,client:"VSCode",cv:v.version,fileName:s.fileName,editorTypeScript:d.join(process.mainModule.filename,"../../extensions/node_modules/typescript")}),s.on("notification",function(e){return i._showNotification(e,s)}),s.on("busy",function(){i._sendToLiveShareClients("busy",s),i.processSessionBusy(s)}),s.on("stopped",function(e){i._sendToLiveShareClients("stopped",s),i._stop(s),i._hideStatusIndicator(),e.deactivate&&(i.stopAll(),i._forceDeactivate())}),s.on("started",function(){i._sendToLiveShareClients("started",s,{mode:s.mode}),i.processStarted(s)}),s.on("stats",function(e){i._sendToLiveShareClients("stats",s,e),s.stats=e,delete s.status,delete s.liveConsoleOutput,delete s.allLiveConsoleOutput,i.processStats(s),e&&e.messages&&(i._valueExplorer.update(s,e.messages),i._runScheduledActionOnResultsAvailable())}),s.on("live",function(){s.fileChangedInEditor(s.fileName,s.textDocument.getText()),s.fileOpenedInEditor(s.fileName)}),s.on("configChanged",function(e){i._pro=e&&e.pro,s.output.setHeaderData(e),s.headerData=e,i._sendToLiveShareClients("configChanged",s,e)}),s.on("documentUpdates",function(e){i._updateDocuments(s,e),i._sendToLiveShareClients("documentUpdates",s,e)}),s.on("consoleError",function(e){e&&e.split("\n").forEach(function(e){return e&&i._debugOutputChannel.appendLine("[Error] #"+s.id+" "+e,"error")}),s.emit("stats",e)}),s.on("consoleLog",function(e){e&&e.split("\n").forEach(function(e){return e&&i._debugOutputChannel.appendLine("[Info]  #"+s.id+" "+e)})}),s.on("consoleOutput",function(e){i._sendToLiveShareClients("consoleOutput",s,e),i._displayLiveConsoleOutput(s,e)})),s.status="progress",this._updateStatus(s,"progress"),u.add(function(){s.output.dispose(),s.stop(),i._clearDecorations(s),delete s.editors,delete s.disposable,delete s.output,s===i._activeSession&&delete i._activeSession,h._clearIdleSessionTimeout(s),i._debugOutputChannel.appendLine("[Info]  #"+s.id+" Quokka.js stopped"),i.outputChannel.clear()}),this.emit("started")},h.prototype.processStats=function(e){e.stats&&(h._outputResults(e.output,e.stats),this._processErrors(e)),this._updateStatus(e),h._sessionIsActive(e)},h.prototype.processStarted=function(e){this._debugOutputChannel.appendLine("[Info]  #"+e.id+" Quokka.js started"),v.workspace.getConfiguration().get("quokka.showOutputOnStart",!0)&&(this._liveShareClientActive()?this._liveShare.outputChannelShown||(this._liveShare.outputChannelShown=!0,this.outputChannel.show(!0)):this.outputChannel.show(!0)),S.showTextDocument(e.textDocument,e.editors&&(e.editors.length||void 0)&&e.editors[0]&&e.editors[0].viewColumn)},h.prototype.processSessionBusy=function(e){var t=this;clearTimeout(this._statusUpdateTimeout),this._statusUpdateTimeout=setTimeout(function(){e.status="progress",t._updateStatus(e,"progress")},300),e.liveConsoleOutput=[],e.allLiveConsoleOutput=[],this._scheduleSessionIdleTimeout(e)},h.prototype._forceDeactivate=function(){this._deactivator(),m.each(u,function(e){return v.commands.registerCommand("quokka."+e,function(){return S.showWarningMessage("Please restart VS Code for a new trial session of Quokka.js 'Pro'.")})})},h.prototype._showNotification=function(e,t){var i=this,o=[];if(!~e.text.indexOf("expire")||"warning"!==e.type||!this._suppressExpirationNotifications){var n=function(e){return e&&e.url&&v.commands.executeCommand("vscode.open",e.url)};if(e.invalidVersion){e.text="You are not licensed to use Quokka PRO features for this version of VS Code. As your 12 months of free Quokka updates have expired, this is likely a result of VS Code updating itself OR that your Quokka extension has automatically updated.",o.push({title:"Renew",url:v.Uri.parse("https://quokkajs.com/pro"),command:n}),o.push({title:"Activate",command:"quokka.showLicense"}),o.push({title:"Switch to 'Community'",command:"quokka.switchToCommunity"});var s="https://quokkajs.com/docs/previous.html?expirydate="+(a=new Date(e.expiryDate)).getUTCFullYear()+"-"+(a.getUTCMonth()+1)+"-"+a.getUTCDate();e.compatibleEditorVersion&&(s=s+"&editortype=VSCode&editor="+encodeURIComponent("VS Code version "+e.compatibleEditorVersion),e.text=e.text+" The last version of VS Code compatible with your license is "+e.compatibleEditorVersion+"."),o.push({title:"Help / Downgrade",url:v.Uri.parse(s),command:n})}else if(e.expiringSoon){var a=new Date(e.expiryDate);e.text="Your Quokka license free upgrades period expires on "+e.expirationDateStringFormatted+". If you would like to work with the latest version of Quokka and future versions released within the next 12 months, please visit our website to upgrade your license.",o.push({title:"Renew",url:v.Uri.parse("https://quokkajs.com/pro"),command:n}),o.push({title:"Activate",command:"quokka.showLicense"});s="https://quokkajs.com/docs/previous.html?expirydate="+a.getUTCFullYear()+"-"+(a.getUTCMonth()+1)+"-"+a.getUTCDate();o.push({title:"Help",url:v.Uri.parse(s),command:n})}else e.suggestProEdition?(o.push({title:"Switch to 'Pro'",command:function(){return i._switchEdition(!0,t)}}),o.push({title:"More info",url:v.Uri.parse("https://quokkajs.com/pro"),command:n})):(~e.text.indexOf("continue-trial-link")&&o.push({title:"Continue Trial",command:function(){return t&&!t.isDisposed()&&t.continueTrial()}}),~e.text.indexOf("activate-link")&&o.push({title:"Activate License",command:"quokka.showLicense"}),~e.text.indexOf("purchase")&&(o.push({title:"Purchase",url:v.Uri.parse("https://quokkajs.com/pro"),command:n}),o.push({title:"Switch to 'Community'",command:"quokka.switchToCommunity"})));e.allowMuting&&o.push({title:"Don't show again",command:function(){return t&&!t.isDisposed()&&t.muteNotification(e.id)}}),e.text=e.text.replace(/<br\/><br\/>/g," ").replace(/<br\/>/g," ").replace(/<[^>]*>/g,"");var r=[e.text].concat(o);S["show"+e.type.charAt(0).toUpperCase()+e.type.substr(1)+("info"===e.type?"rmation":"")+"Message"].apply(S,r).then(this._executeCommand),0===e.text.indexOf("Can not start node.js process")&&S.showInformationMessage('You may use the "node" setting to configure the location of node.',{title:"More info",url:v.Uri.parse("https://quokkajs.com/docs/configuration.html#nodejs-version")}).then(function(e){e&&e.url&&v.commands.executeCommand("vscode.open",e.url)})}},h.prototype._checkAndSyncSession=function(t){return!!S.visibleTextEditors.find(function(e){return e.document===t.textDocument})&&(t!=this._activeSession&&(this._activeSession&&this._activeSession.output.disableChannel(),(this._activeSession=t).output.enableChannel(),t.output.render(),this.processStats(t)),!0)},h.prototype.showLicense=function(){var c=this,l="";try{l=f.readFileSync(this._lkp).toString()}catch(e){}S.showInputBox({value:100<l.length?l:"",prompt:"Enter your Quokka.js 'Pro' license key"}).then(function(e){if(!m.isUndefined(e)){var t=l,i=e||"",o=!!c._parseLicenseKey(t),n=c._parseLicenseKey(i),s=!!n,a=!1;if(s||!i&&o)try{if(f.writeFileSync(c._lkp,i),n.isBundle){var r=d.join(_.homedir(),".wallaby"),u=d.join(r,"key.lic");f.existsSync(r)||f.mkdirSync(r),f.writeFileSync(u,i)}a=s}catch(e){S.showErrorMessage("Unable to save license key: "+e.message),a=!1}else S.showWarningMessage("The entered license key is not a valid Quokka.js 'Pro' license key.");a&&(S.showInformationMessage("Quokka.js 'Pro' is licensed to: "+n.licensee+". Free upgrades until: "+n.expiration+"."),c.switchToPro())}})},h.prototype._parseLicenseKey=function(e){if(m.isString(e))try{var t=this._utils.parseKey(e);if(t.licenseeName&&t.expirationDateString&&~t.licensedProduct.indexOf("Quokka"))return{licensee:t.licenseeName,isBundle:0===t.licensedProduct.indexOf("Wallaby.js + Quokka.js"),expiration:t.expirationDateStringFormatted||t.expirationDateString}}catch(e){return}},h.prototype.switchToCommunity=function(){this._switchEdition(!1,this._activeSession)},h.prototype.switchToPro=function(){this._switchEdition(!0,this._activeSession)},h.prototype._switchEdition=function(e,t){var i=this._loadQuokkaConfig();if(i.pro=e,this._pro=e,this._saveQuokkaConfig(i),this._pro&&this._salesEvent&&(this._salesEvent.deleteStateConfig(),this._salesEvent.dispose(),delete this._salesEvent),!this._liveShareClientActive()&&t&&!t.isDisposed()){var o=t.textDocument,n=t.editors[0];this.stopAll(),t.mode!=C&&t.mode!==c||this._start(o,n,t.mode)}},h.prototype._processErrors=function(e){var t=this;this._liveShareClientActive()||e.stats.errors&&(e.errorDataByLine={},h._addLineData(e,h._createLineDataObject(e,function(e){return e.missingPackage},function(e){return[{title:'Install "'+e.missingPackage+'" package for the current quokka file',command:"installMissingPackageToQuokka"},t._projectRoot()&&{title:'Install "'+e.missingPackage+'" package into the project',command:"installMissingPackageToProject"}]})),h._addLineData(e,h._createLineDataObject(e,function(e){return e.missingBrowserGlobal},function(e){return[{title:'"'+e.missingBrowserGlobal+'" looks like a browser global'},{title:"Install and use quokka browser plugin",command:"installQuokkaPlugin",arg:"jsdom-quokka-plugin"}]})),h._addLineData(e,h._createLineDataObject(e,function(e){return e.undefinedName},function(e){return[{title:'Add "import '+e.undefinedName+" from '"+e.undefinedName+"';\"",command:"addImport",arg:e.undefinedName},{title:'Add "const '+e.undefinedName+" = require('"+e.undefinedName+"');\"",command:"addRequire",arg:e.undefinedName}]})))},h._addLineData=function(e,t){t&&(e.errorDataByLine[t.line]=t)},h._createHoverObject=function(e){return e.filter(function(e){return!!e}).map(function(e){return e.command?"\n["+e.title+"]("+encodeURI("command:quokka."+e.command+(e.arg?"?"+JSON.stringify(e.arg):""))+")":e.title}).join("\n")},h._createCommands=function(e){return e.filter(function(e){return e&&e.command}).map(function(e){return{title:e.title,command:"quokka."+e.command,arguments:e.arg?[e.arg]:void 0}})},h._createLineDataObject=function(t,e,i){var o=t.stats.errors.find(e),n=o&&o.stack||[];if(n.reverse(),n.length){var s=m.find(n,function(e){return e.file===t.fileName});if(s&&s.loc&&s.loc.split){var a=i(o),r=h._createHoverObject(a);return v.MarkdownString&&((r=new v.MarkdownString(r)).isTrusted=!0),{line:parseInt(s.loc.split(":")[0],10)-1,hover:{value:r},commands:h._createCommands(a)}}}},h._checkConfigurationSettings=function(){try{var e=v.workspace.getConfiguration();if(e)e.get("quokka.suppressGlyphMarginNotifications",!1)||e.get("editor.glyphMargin",!0)||S.showWarningMessage("Quokka.js will not display coverage indicators in the gutter because the `editor.glyphMargin` setting is set to `false`. You can hide this message by setting `quokka.suppressGlyphMarginNotifications` to `false`.")}catch(e){}},h.prototype._updateConfigurationFromSettings=function(){var e="",t=!1;try{var i=this._loadQuokkaConfig();e=i.node,i.useWsl&&(t=i.useWsl)}catch(e){}try{process.env.WALLABY_USE_WSL=t;var o=v.workspace.getConfiguration();if(o){this._suppressExpirationNotifications=o.get("quokka.suppressExpirationNotifications",!1),this._colorizeOutput=o.get("quokka.colorizeOutput",!0),this._compactMessageOutput=o.get("quokka.compactMessageOutput",!1);var n=o.get("quokka.node",e);n?process.env.WALLABY_NODE=n:delete process.env.WALLABY_NODE}}catch(e){}},h.prototype.activate=function(){var e=this;this._onceDocumentStopsChanging=m.debounce(m.bind(this._onceDocumentStopsChanging,this),100),h._outputResults=m.debounce(m.bind(h._outputResults,this),100),this._statusBar.updateText=m.debounce(m.bind(this._statusBar.updateText,this._statusBar),200),this._executeCommand=m.bind(this._execute,this),this._statusBar.command="quokka.showOutput",this._disposables.add(function(){e._statusBar&&e._statusBar.hide(),e._activeSessions.forEach(function(e){return e.disposable.dispose()}),e._activeSessions.length=0})},h.prototype._projectRoot=function(t){var e,i=this;if(t&&(this._multiFolderWorkspaces&&y.workspaceFolders&&y.workspaceFolders.length&&(e=m.find(y.workspaceFolders,function(e){return~t.indexOf(e.uri.fsPath+d.sep)}))))return this._currectProjectRoot=e.uri.fsPath,this._currectProjectRoot;if(this._currectProjectRoot)if(this._multiFolderWorkspaces&&y.workspaceFolders){if(e=m.find(y.workspaceFolders,function(e){return i._currectProjectRoot===e.uri.fsPath}))return e.uri.fsPath}else if(y.rootPath&&this._currectProjectRoot===y.rootPath)return y.rootPath;return this._multiFolderWorkspaces&&y.workspaceFolders?y.workspaceFolders.length?y.workspaceFolders[0].uri.fsPath:void 0:y.rootPath||""},h.prototype.selectWorkspaceFolder=function(){var t=this;this._multiFolderWorkspaces&&y.workspaceFolders&&1<y.workspaceFolders.length&&S.showWorkspaceFolderPick&&S.showWorkspaceFolderPick().then(function(e){e&&(t._currectProjectRoot=e.uri.fsPath)})},h.prototype.deactivate=function(){this._disposables.dispose()},h._sessionIsActive=function(e){h._clearIdleSessionTimeout(e)},h.prototype._sessionIsIdle=function(e){this._clearDecorations(e),delete e.stats,e.liveConsoleOutput&&!e.liveConsoleOutput.started&&e.output.clearAndRenderHeader()},h._clearIdleSessionTimeout=function(e){e.idleTimeout&&(clearTimeout(e.idleTimeout),delete e.idleTimeout)},h.prototype._clearDecorations=function(e){var i=this;e.editors.forEach(function(t){m.each(i._coverageDecorationTypes,function(e){return t.setDecorations(e,[])}),t.setDecorations(i._hideAfterContentDecorationType,[])})},h.prototype._scheduleSessionIdleTimeout=function(e){var t=this;h._clearIdleSessionTimeout(e),e.idleTimeout=setTimeout(function(){return t._sessionIsIdle(e)},3500)},h.prototype._displayLiveConsoleOutput=function(e,t){var i=this;if(e.liveConsoleOutput){var o=e.liveConsoleOutput.started;e.liveConsoleOutput=e.liveConsoleOutput.concat(t),e.liveConsoleOutput.started=o,e.liveConsoleOutput.started?e.displayLiveConsoleOutputTimeout||this._displayPendingLiveConsoleOutput(e):(e.liveConsoleOutput.started=!0,e.displayLiveConsoleOutputTimeout=setTimeout(function(){delete e.displayLiveConsoleOutputTimeout,e.liveConsoleOutput&&e.liveConsoleOutput.length&&(e.output.clearAndRenderHeader(),i._displayPendingLiveConsoleOutput(e))},150))}},h.prototype._displayPendingLiveConsoleOutput=function(t){t.allLiveConsoleOutput=t.allLiveConsoleOutput.concat(t.liveConsoleOutput),t.liveConsoleOutput.forEach(function(e){return t.output.appendConsoleMessage(e)}),t.liveConsoleOutput.length=0},h.prototype._execute=function(e){if(e&&e.command)return"function"==typeof e.command?e.command(e):~e.command.indexOf("quokka.")?v.commands.executeCommand(e.command):this[e.command]()},h.prototype._processDocumentContentChange=function(e,t,i,o){e.isDisposed()||t&&t.uri&&t.uri.scheme&&"file"!==t.uri.scheme&&"untitled"!==t.uri.scheme&&"vsls"!==t.uri.scheme||(e.changes=e.changes.concat(i),this._hideMessagesForChangedRanges(e.changes),o&&this._onceDocumentStopsChanging(e,t))},h.prototype._onceDocumentStopsChanging=function(e,t){var i=this;!e.isDisposed()&&e.changes.length&&(this._liveShareClientActive()||(clearTimeout(this._statusUpdateTimeout),this._statusUpdateTimeout=setTimeout(function(){e.status="progress",i._updateStatus(e,"progress")},300),e.fileChangedInEditor(e.fileName,t.getText(),{start:m.chain(e.changes).map(function(e){return e.range.start.line}).min().value()+1,end:m.chain(e.changes).map(function(e){return e.range.end.line}).max().value()+1},!1),e.changes=[]))},h.prototype._updateStatus=function(e){if(!e.isDisposed()){var t,i=e.status;clearTimeout(this._statusUpdateTimeout),i||(i=m.isString(e.stats)?"failing":e.stats?e.stats.errors.length?"failing":"passing":"failing",t=e.stats&&e.stats.time),i&&("progress"===i?this._statusBar.displayProgress():(this._statusBar.stopProgress(),this._statusBar.setMainText(("failing"===i?"‚úó":"‚úî")+(t?" "+t+"ms":"")),this._statusBar.updateText()),this._statusBar.show()),this._activeSession=e}},h.prototype._updateStatusExtension=function(e){this._statusBar.setExtensionText(e),this._statusBar.updateText()},h.prototype._removeStatus=function(){this._statusBar.hide()},h.prototype._updateDocuments=function(t,o){var n=this;t.isDisposed()||(t.documentUpdates=o,m.each(S.visibleTextEditors,function(i){var a=i.document;if(a===t.textDocument){var e=o[t.fileName];if(e&&e.lines){var r={1:[],2:[],3:[],4:[],5:[]};m.each(e.lines,function(e){var t=e.num-1;if(!(t<0||t>=a.lineCount)){var i=a.lineAt(t);if(i){var o={range:new v.Range(i.lineNumber,i.firstNonWhitespaceCharacterIndex,i.lineNumber,i.range.end.character)},n=e.log||e.err,s=e.longLog||n;s&&(o.hoverMessage=v.MarkdownString?new v.MarkdownString("```\n"+s+"\n```"):{value:s}),r[e.state].push(o),n&&(o.renderOptions={after:{contentText:n}})}}}),m.each(r,function(e,t){return i.setDecorations(n._coverageDecorationTypes[t],e)}),n._scheduleHiddenMessagesDisplay()}}}))},h.prototype._hideMessagesForChangedRanges=function(e){clearTimeout(this._displayHiddenMessagesTimeout),this._messagesHiddenAt=+new Date,S.activeTextEditor&&S.activeTextEditor.setDecorations(this._hideAfterContentDecorationType,e.map(function(e){return{range:new v.Range(e.range.start.line,0,e.range.end.line,Number.MAX_SAFE_INTEGER)}}))},h.prototype._scheduleHiddenMessagesDisplay=function(){var t=this;clearTimeout(this._displayHiddenMessagesTimeout);var e=this._messagesHiddenAt?+new Date-this._messagesHiddenAt:400;this._displayHiddenMessagesTimeout=setTimeout(function(){try{m.each(S.visibleTextEditors,function(e){return e&&e.setDecorations(t._hideAfterContentDecorationType,[])})}catch(e){}},Math.max(0,500-e))},h.prototype._navigate=function(e,t){if(e){var i,o,n=this._absoluteFilePath(e);m.isNumber(t)?i=t:m.isArray(t)?(i=t[0],o=t[1]):m.isString(t)&&(t=t.split(":"),i=t[0]&&parseInt(t[0],10),o=t[1]&&parseInt(t[1],10)),m.isNumber(i)?i-=1:i=0,m.isNumber(o)||(o=0),y.openTextDocument(n).then(function(e){return S.showTextDocument(e)}).then(function(e){var t=new v.Position(i,o);e.revealRange(new v.Range(t,t)),e.selection=new v.Selection(t,t)})}},h.prototype._absoluteFilePath=function(e){return d.resolve(this._projectRoot(),e)},h._outputResults=function(e,t,i){var o,n=e.lines();e.build(t);var s=e.lines();if(!(o=i||s.length!==n.length))for(var a=0,r=s.length;a<r;a++)if(e.areDifferent(s[a],n[a])){o=!0;break}o&&e.render()},h}(s);t.exports=h},{"./SalesEvent":3,"./compositeDisposable":4,"./outputBuilder":6,"./valueExplorer":7,fs:void 0,os:void 0,path:void 0,vscode:void 0}],6:[function(e,t,i){"use strict";var p=e("vscode"),h=global._,o={text:"",link:Array(2).join("‚Äã"),error:{start:"",end:"‚Äá"},duration:Array(4).join("‚Äã"),suite:Array(5).join("‚Äã"),message:{start:"",end:"‚Äà",altEnd:" "+Array(6).join("‚Äã")},diffIns:Array(2).join("‚Äå‚Å†"),diffDel:Array(2).join("‚Äç"),tmpDiffIns:{start:"wsDiffIns",end:"weDiffIns"},tmpDiffDel:{start:"wsDiffDel",end:"weDiffDel"}},n=function(){function e(e,t,i,o,n,s,a,r,u,c){var l=this;this._lines=[],this._links=[],this._quokkaFileName=t,this._displayedFileName=u,this._contentLimit=1048576,this._channel=e,this._absolutePathResolver=i,this._dmp=o,this._hasOpenedProject=a,this.render=h.debounce(h.bind(this.render,this),300),this._header="Quokka",this.isLiveShareClient=r,this.disposed=!1,this.channelEnabled=!0,this._messageSeparator=c?"":"\n",this.useMarkup(),n.add(p.languages.registerDocumentLinkProvider(s,{provideDocumentLinks:function(e){if(!l.channelEnabled||l.disposed)return[];var t=e.lineAt(0);return t&&t.text&&~t.text.indexOf(l._header)?l._links:[]}}))}return e.prototype.enableChannel=function(){this.channelEnabled=!0},e.prototype.disableChannel=function(){this.channelEnabled=!1},e.prototype.useMarkup=function(){this._markupTokens=h.extend({},o)},e.prototype.disableMarkup=function(){this._markupTokens.text=this._markupTokens.link=this._markupTokens.error=this._markupTokens.duration=this._markupTokens.suite=this._markupTokens.message=""},e.prototype.dispose=function(){this.disposed=!0},e.prototype.build=function(e){var t=this;this._lines=[],this._links=[],this._appendLine("suite",0,this._header),h.isString(e)?this._appendLine("error",0,e):h.isObject(e)&&(h.each(e.errors,function(e){return t._outputError(e)}),h.each(e.messages,function(e){return t._outputMessage(e)}))},e.prototype.lines=function(){return this._lines},e.prototype.render=function(){this._doRender()},e.prototype._doRender=function(e){if(!this.disposed&&this.channelEnabled){!(e=e||0)&&this._channel.clear();for(var t="",i=e,o=this._lines.length;i<o;i++){if((t+=this._lines[i]+"\n").length>this._contentLimit){t+="\n--- output truncated to "+this._contentLimit+" bytes ---\n";break}}this._channel.append(t)}},e.prototype.clear=function(){this._lines=[],this._links=[]},e.prototype.clearAndRenderHeader=function(){this.clear(),this._appendLine("suite",0,this._header),this._doRender()},e.prototype.appendConsoleMessage=function(e){var t=this._lines.length;this._outputMessage(e),this._doRender(t)},e.prototype.show=function(){this.disposed||this._channel.show(!0)},e.prototype.areDifferent=function(e,t){return e!==t},e.prototype.setContentLimit=function(e){e&&(this._contentLimit=e)},e.prototype.setHeaderData=function(e){if(!this.disposed){var t=e.plugins||[];try{this._header="Quokka '"+this._displayedFileName+"' (node: "+e.nodeVersion+(e.ts?", TypeScript: "+(e.ts.version&&"v"+e.ts.version||"unknown version"):"")+(e.babel?", babel: "+(e.babel.version&&"v"+e.babel.version||"unknown version"):"")+(t.length?", plugins: "+t.join(", "):"")+")"}catch(e){console.log(e)}}},e.prototype._markupStartToken=function(e){var t=this._markupTokens[e];return h.isObject(t)?t.start:t},e.prototype._markupEndToken=function(e){var t=this._markupTokens[e];return h.isObject(t)?t.end:t},e.prototype._markupAltEndToken=function(e){var t=this._markupTokens[e];return h.isObject(t)?t.altEnd||t.end:t},e.prototype._outputMessage=function(e){if("diff"===e.type){if(!e.context&&!e.actual&&!e.expected)return;e.text=e.context,delete e.context}e.context&&e.context.replace&&(e.context=e.context.replace(/\r\n\s*/g," ").replace(/\n\s*/g," "));var t=e.text&&(20<e.text.length||~e.text.indexOf("\n"))&&"diff"!==e.type,i="error"===e.type?"error":"warn"===e.type||"diff"===e.type?"duration":"message";if(t)this._appendLine(i,0,this._messageSeparator+e.text),this._outputLink(e,1);else{"diff"===e.type&&this._outputDiff(0,e.expected,e.actual);var o=e.text?""+this._messageSeparator+this._markupStartToken(i)+e.text+this._markupAltEndToken(i):"";if(e.file){"message"!==i&&(o+=" ");var n=this._markupStartToken("link")+e.file+(e.loc?":"+e.loc:"")+this._markupEndToken("link");o+="at "+(e.context?this._markupStartToken("duration")+e.context+this._markupEndToken("duration")+" ":""),o+=n,this._addFileLink(e.file,e.loc,n,o.length-n.length,this._lines.length+(o.split(/\r\n|\r|\n/).length-1))}this._appendLine("text",0,o)}},e.prototype._outputError=function(e){var t=e.message,i=e.stack,o=e.expected,n=e.actual,s=e.missingPackage,a=e.missingBrowserGlobal,r=this;this._outputDiff(0,o,n),s&&!this.isLiveShareClient&&(this._addEmptyLine(),this._addCustomLinkLine('Install "'+s+'" package for the current quokka file',"command:quokka.installMissingPackageToQuokka",0),this._hasOpenedProject&&this._addCustomLinkLine('Install "'+s+'" package into the project',"command:quokka.installMissingPackageToProject",0)),a&&!this.isLiveShareClient&&(this._addEmptyLine(),this._appendLine("duration",0,'"'+a+'" looks like a browser global'),this._addCustomLinkLine("Install and use quokka browser plugin","command:quokka.installQuokkaPlugin?"+JSON.stringify("jsdom-quokka-plugin"),0),this._addCustomLinkLine("Open quokka browser plugin documentation","https://github.com/wallabyjs/jsdom-quokka-plugin",0)),this._appendLine("error",0,this._messageSeparator+t),h.each(i,function(e){return r._outputLink(e,1)})},e.prototype._outputDiff=function(e,t,i){var s=this;if(this._dmp&&(t||i)){var o="\n"+this._dmp.diff_prettyHtml(this._dmp.diff_wordMode(t||"",i||"")).replace(/&para;<br>/g,"\n").replace(/<br>/g,"\n").replace(/<\/?span[^>]*>/g,"").replace(/<ins[^>]*>/g,this._markupStartToken("tmpDiffIns")).replace(/<del[^>]*>/g,this._markupStartToken("tmpDiffDel")).replace(/<\/ins[^>]*>/g,this._markupEndToken("tmpDiffIns")).replace(/<\/del[^>]*>/g,this._markupEndToken("tmpDiffDel")).replace(/style="background:#e6ffe6;"/g,"").replace(/style="background:#ffe6e6;"/g,"").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&gt;/g,">"),a=0,r=0;this._appendLine("none",e,o,void 0,void 0,function(e){if(!e)return e;0<a&&(e=s._markupStartToken("diffIns")+e),0<r&&(e=s._markupStartToken("diffDel")+e);var t=(e.match(new RegExp(s._markupStartToken("tmpDiffIns"),"g"))||[]).length,i=(e.match(new RegExp(s._markupEndToken("tmpDiffIns"),"g"))||[]).length;a+=t-i;var o=(e.match(new RegExp(s._markupStartToken("tmpDiffDel"),"g"))||[]).length,n=(e.match(new RegExp(s._markupEndToken("tmpDiffDel"),"g"))||[]).length;return r+=o-n,0<a&&(e+=s._markupEndToken("diffIns")),0<r&&(e+=s._markupEndToken("diffDel")),e.replace(new RegExp(s._markupStartToken("tmpDiffIns"),"g"),s._markupStartToken("diffIns")).replace(new RegExp(s._markupEndToken("tmpDiffIns"),"g"),s._markupEndToken("diffIns")).replace(new RegExp(s._markupStartToken("tmpDiffDel"),"g"),s._markupStartToken("diffDel")).replace(new RegExp(s._markupEndToken("tmpDiffDel"),"g"),s._markupEndToken("diffDel"))})}},e.prototype._outputLink=function(i,e){var o=this;if(i.file){var n=i.file+(i.loc?":"+i.loc:"");this._appendLine("link",e,n,void 0,i.context,function(e,t){o._addFileLink(i.file,i.loc,n,t)})}},e.prototype._addCustomLinkLine=function(e,t,i){var o=this._lines.length;this._appendLine("text",i,this._markupStartToken("link")+e+this._markupEndToken("link")),this._links.push({range:new p.Range(o,this._markupStartToken("link").length,o,e.length+this._markupEndToken("link").length),target:p.Uri.parse(t)})},e.prototype._addFileLink=function(e,t,i,o,n){"."!==e[0]&&e!==this._quokkaFileName||(n=n||this._lines.length,this._links.push({range:new p.Range(n,o,n,o+i.length),target:0===e.indexOf("quokka")?p.Uri.parse("command:quokka.goToLineInQuokkaFile?"+JSON.stringify(this._location(t).substring(1))):p.Uri.parse(p.Uri.file(this._absolutePathResolver(e)).toString()+this._location(t,0))}))},e.prototype._location=function(e,t){var i,o;return h.isNumber(e)?i=e:h.isArray(e)?(i=e[0],o=e[1]):h.isString(e)&&(i=(e=e.split(":"))[0]&&parseInt(e[0],10),o=e[1]&&parseInt(e[1],10)),h.isNumber(o)&&(o+=void 0!==t?t:1)<0&&(o=0),"#"+(h.isNumber(o)?i+","+o:i)},e.prototype._addEmptyLine=function(){this._appendLine("text",0,"")},e.prototype._appendLine=function(n,s,e,a,r,u){var c=this,l=this,t=e.split("\n"),p=[this._markupStartToken(n)||"",this._markupEndToken(n)||""];h.each(t,function(e){var t=(a?"["+a+"] ":"")+h.pad("",2*s,"   ")+("link"===n?"at "+(r?c._markupStartToken("duration")+r+c._markupEndToken("duration")+" ":""):"")+p[0],i=t+e+p[1];if(u){var o=u(i,t.length);o&&(i=o)}l._lines.push(i)})},e}();t.exports=n},{vscode:void 0}],7:[function(e,t,i){"use strict";var s=e("vscode"),a=global._,o=function(){function n(e){this._context=e,this._docsNode={label:"No logged values, click to see the feature docs",iconPath:this._context.asAbsolutePath("images/question.svg"),command:{command:"vscode.open",arguments:[s.Uri.parse("https://quokkajs.com/docs/#value-explorer")]}},this._treeDataProvider=new c(this._docsNode),this._treeDataProvider._rootNodes={},s.window.registerTreeDataProvider&&s.window.registerTreeDataProvider("quokkaValueExplorer",this._treeDataProvider)}return n.prototype.remove=function(e){var t=this._treeDataProvider._rootNodes,i=t[e.id];delete t[e.id],i&&i._context.cancelPendingUpdates(),this._treeDataProvider.refresh()},n.prototype.update=function(e,t){var i=this._treeDataProvider._rootNodes[e.id];if(!i){var o=new r(this._context,e);i=new u(o,{label:{name:""+e.id},id:e.id,sessionNode:!0,disallowToCopyPath:!0,disallowToCopyData:!0}),this._treeDataProvider._rootNodes[e.id]=i}i._children=a.chain(t).map(function(e){var t=(e.valueBag||{}).data;if(t){t.name||n.removeSpacesTabsLineBreaks(e.text||"").startsWith(n.removeSpacesTabsLineBreaks(e.context||"").replace(/\.\.\.$/g,""))||(t.name=n.removeSpacesTabsLineBreaks(e.context||""));var i=(e.loc||"").split(":")[0];return i&&(t.name="line "+i+(t.name?": "+t.name:"")),t.label=t.label||{},t.label.name=t.name,t.context=e.context,t.rootValueNode=!0,t}}).filter(function(e){return!!e}).map(function(e){return new u(i._context,e,i,e.autoExpand)}).value(),i._context.runPendingUpdates(),i._children&&i._children.length||(i._children=[this._docsNode]),this._treeDataProvider.refresh()},n.removeSpacesTabsLineBreaks=function(e){return e&&e.replace(/\s/g,"")},n}(),r=function(){function e(e,t){this._expressionsToEvaluate={},this._onUpdate=[],this._extensionContext=e,this._session=t,this.id=t.id}return e.prototype.asAbsolutePath=function(e){return this._extensionContext.asAbsolutePath(e)},e.prototype.isPathRequested=function(e,t){var i=this._expressionsToEvaluate,o=a.every(e,function(e){return!!i[e]&&(i=i[e],!0)});return o&&t?JSON.stringify(t)===JSON.stringify(i):o},e.prototype.requestNodes=function(e,t){var i=this._expressionsToEvaluate;a.each(e,function(e){i[e]=i[e]||{},i=i[e]}),t&&(i.props=t.props,i.strLength=t.strLength,i.ranges=t.ranges),this._session.isDisposed()||(this._session.expressionsToEvaluate(this._expressionsToEvaluate),this._session.runTests({file:this._session.fileName}))},e.prototype.scheduleOnUpdate=function(e){this._onUpdate.push(e)},e.prototype.copyToClipboard=function(e){!this._session.isDisposed()&&this._session.copyToClipboard(e)},e.prototype.cancelPendingUpdates=function(){this._onUpdate=[]},e.prototype.runPendingUpdates=function(){a.each(this._onUpdate,function(e){return e()}),this._onUpdate.length=0},e}(),u=function(){function t(e,t,i,o){this._context=e,this._parent=i,this._data=t,this.label=this._createLabel(),this._queryPath=t.queryPath,this.id=(o?"A":"")+t.id,this.iconPath=this._getIconPath(),t.disallowToCopyPath||(this.contextValue+="QuokkaAllowToCopyPath"),t.disallowToCopyData||(this.contextValue+="QuokkaAllowToCopyData"),this._autoExpand=o&&!this._data.cappedProps&&!this._data.capped&&!this._data.loadActionNode&&!this._data.rangeNode&&"string"!==this._data.type&&!this._data.getter&&!this._data.setter,t.sessionNode?this.collapsibleState=2:this.collapsibleState=t.expandable?this._autoExpand?2:1:0,t.rangeNode&&(this._parentArray=i._parentArray||i,this._queryPath=this._parentArray._queryPath),t.sessionNode&&(this.iconPath=s.ThemeIcon.File,this.resourceUri=s.Uri.file(this.id))}return t.prototype.getChildren=function(){var i=this;if(this._children)return this._children;if("string"===this._data.type)return this._getChildren({strLength:Number.MAX_VALUE});if(this._data.loadActionNode)return this._getChildren({props:Number.MAX_VALUE});var e=(this._data.props||[]).map(function(e){return new t(i._context,e,i,i._autoExpand)});return e.length?Promise.resolve(e):this._data.rangeNode?this._getChildren({ranges:{props:JSON.parse(JSON.stringify(this._parentArray._data.props,function(e,t){return t.props&&(!t.props.length&&t===i._data||t.props.length&&!t.props[0].rangeNode)&&(t.props=!0),t})),length:this._parentArray._data.length}}):this._getChildren()},t.prototype.copyExpressionPath=function(){(this._data||{}).expressionPath&&this._context.copyToClipboard(this._data.expressionPath.join(""))},t.prototype.copyExpressionData=function(){this._data&&this._context.copyToClipboard(this._data)},t.prototype._getChildren=function(e){var i=this;return this._context.isPathRequested(this._queryPath,e)?[]:(this._context.requestNodes(this._queryPath,e),new Promise(function(e,t){i._context.scheduleOnUpdate(e)}))},t.prototype._getIconPath=function(){if(this._data.getter)return this._context.asAbsolutePath("images/getter.svg");if(this._data.functionsNode)return this._context.asAbsolutePath("images/function.svg");if(this._data.loadActionNode)return this._context.asAbsolutePath("images/more.svg");if(this._data.error)return this._context.asAbsolutePath("images/error.svg");if(this._data.rangeNode)return this._context.asAbsolutePath("images/range.svg");if(!this._data.sessionNode){if(this._data.type)switch(this._data.type.toLowerCase()){case"string":if(this._data.capped)return this._context.asAbsolutePath("images/cappedString.svg");case"object":case"array":case"number":case"function":case"boolean":case"date":case"regexp":case"symbol":case"null":case"undefined":return this._context.asAbsolutePath("images/"+this._data.type.toLowerCase()+".svg")}return this._context.asAbsolutePath("images/object.svg")}},t.prototype._createLabel=function(){var e=this._data.label,t="";return e.name&&(t+=e.name),e.type&&(t+=": "+e.type+" "),e.value&&(t+=(e.type?"":": ")+e.value),t},t}(),c=function(){function e(e){this._onDidChangeTreeData=new s.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event,this._docsNode=e}return e.prototype.refresh=function(){this._onDidChangeTreeData.fire()},e.prototype.getTreeItem=function(e){return e},e.prototype.getChildren=function(e){return e?e.getChildren():a.isEmpty(this._rootNodes)?Promise.resolve([this._docsNode]):Promise.resolve(a.chain(this._rootNodes).values().sortBy(function(e){return e._data.name}).value())},e}();t.exports=o},{vscode:void 0}]},{},[2]);